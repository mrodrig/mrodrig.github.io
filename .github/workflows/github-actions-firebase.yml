name: Firebase
on: [push]
jobs:
  deploy-dev:
    concurrency: 
      group: ${{ github.workflow }}-${{ github.ref }}
      cancel-in-progress: true
    runs-on: ubuntu-latest
    needs: []
    environment:
      name: Development
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3

      - name: Install Firebase CLI ğŸ”§
        run: |
          cd firebase
          npm install --location=global firebase-tools

      - name: Deploy ğŸš€
        run: |
          cd firebase
          firebase use $ENVIRONMENT
          firebase deploy --project=$ENVIRONMENT

  deploy-prod:
    concurrency: 
      group: ${{ github.workflow }}-${{ github.ref }}
      cancel-in-progress: true
    runs-on: ubuntu-latest
    needs: [deploy-dev]
    environment:
      name: Production-manual
      url: https://mrodrig.github.io
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3

      - name: Install Firebase CLI ğŸ”§
        run: |
          cd firebase
          npm install --location=global firebase-tools

      - name: Deploy ğŸš€
        run: |
          cd firebase
          firebase use $ENVIRONMENT
          firebase deploy
